# 8. 데몬 스레드 (Daemon Thread)

데몬 스레드는 자바에서 일반 스레드를 **보조**하는 역할을 수행하는 특별한 종류의 스레드입니다. 일반적으로 시스템 작업, 로그 처리, 자원 정리 등의 **백그라운드 작업**에 사용되며, **일반 스레드**가 모두 종료되면 데몬 스레드는 **자동으로 종료**됩니다.

## 8.1 **데몬 스레드의 특징**

1) **자동 종료**
   - **데몬 스레드**는 모든 **일반 스레드**가 종료되면 **자동으로 종료**됩니다. 즉, 프로그램이 종료되면 더 이상 데몬 스레드가 필요하지 않기 때문에 강제로 종료됩니다.
   - 일반 스레드는 종료되기 전까지 프로그램이 계속 실행되지만, 데몬 스레드는 일반 스레드가 모두 종료되면 강제적으로 **자동 종료**됩니다.

2) **데몬 스레드 설정**
   - **`setDaemon(true)`** 메서드를 호출하여 스레드를 **데몬 스레드**로 설정할 수 있습니다.
   - 이 메서드는 **스레드를 시작하기 전**에 호출해야 하며, 그렇지 않으면 **IllegalThreadStateException**이 발생합니다.

   ```java
   Thread t = new Thread(new MyRunnable());
   t.setDaemon(true);  // 데몬 스레드로 설정
   t.start();  // 스레드 시작
   ```

3) **데몬 스레드의 역할**
   - 주로 **백그라운드 작업**에 사용되며, 예를 들어 **GC(가비지 컬렉션)**, 로그 기록, **파일 백업** 등의 작업을 수행합니다. 이런 작업들은 프로그램 실행 중 지속적으로 수행되지만, 프로그램이 종료되면 더 이상 필요하지 않으므로 데몬 스레드가 이 역할을 담당합니다.

4) **데몬 스레드의 자손**
   - 데몬 스레드에서 생성된 스레드는 **자동으로 데몬 스레드**가 됩니다.

---

## 8.2 **데몬 스레드 예시**

### 예시 1: 기본 데몬 스레드
아래 코드는 일반 스레드가 모두 종료되면 데몬 스레드가 자동으로 종료되는 예시입니다.

```java
public class DaemonThreadExample {
    public static void main(String[] args) {
        Thread daemonThread = new Thread(() -> {
            while (true) {
                System.out.println("Daemon thread is running...");
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        });

        daemonThread.setDaemon(true);  // 데몬 스레드로 설정
        daemonThread.start();  // 스레드 시작

        // 일반 스레드
        Thread userThread = new Thread(() -> {
            try {
                Thread.sleep(3000);  // 3초 후 종료
                System.out.println("User thread is done.");
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        });

        userThread.start();  // 일반 스레드 시작
    }
}
```

### 실행 결과:
- **User thread**가 3초 후에 종료되면, **Daemon thread**도 자동으로 종료됩니다.
- 데몬 스레드는 **백그라운드 작업**을 수행하되, 일반 스레드가 모두 종료되면 더 이상 실행되지 않습니다.

---

## 8.3 **주의 사항**
1) **데몬 스레드는 데이터 처리에 신중해야 함**
   - 데몬 스레드는 **강제 종료**될 수 있기 때문에 중요한 데이터를 처리하거나 자원을 정리하는 작업에는 적합하지 않습니다. 이러한 작업은 반드시 일반 스레드에서 수행해야 합니다.

2) **`setDaemon(true)`는 스레드 시작 전에 설정**
   - 데몬 스레드는 **스레드를 시작하기 전에** 설정해야 하며, 그렇지 않으면 **예외**가 발생합니다.

```java
Thread t = new Thread(new MyRunnable());
t.setDaemon(true);  // 스레드를 시작하기 전에 설정
t.start();  // 스레드 시작
```

---

## 8.4 **데몬 스레드와 일반 스레드의 차이점**

| 구분           | 일반 스레드                                      | 데몬 스레드                                  |
|----------------|--------------------------------------------------|----------------------------------------------|
| **목적**       | 프로그램의 주요 작업을 처리                        | 프로그램의 보조 작업을 처리                  |
| **종료 시점**  | 모든 작업이 끝날 때까지 실행                      | 모든 일반 스레드가 종료되면 자동으로 종료됨 |
| **사용 용도**  | 파일 처리, 데이터베이스 작업, 네트워크 통신 등     | 가비지 컬렉션, 로그 기록, 자원 정리 작업 등  |
| **설정 방법**  | 별도의 설정 필요 없음                             | `setDaemon(true)` 호출 필요                  |

---

## 8.5 **결론**

- **데몬 스레드**는 백그라운드에서 보조 작업을 수행하며, **일반 스레드**가 종료되면 자동으로 종료됩니다.
- 주로 **가비지 컬렉션**, **로그 기록** 등 중요한 메인 작업이 아닌 부가 작업에 사용됩니다.
- 중요한 작업은 **일반 스레드**에서 수행해야 하며, **데몬 스레드**는 보조적 역할을 위해 사용해야 합니다.