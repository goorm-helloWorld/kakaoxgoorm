# **Spring과 데이터베이스**

Spring 프레임워크에서 데이터베이스와의 상호작용은 다양한 방식으로 이루어집니다. 각 방법은 사용 목적과 복잡성에 따라 선택할 수 있습니다. 여기서는 H2 데이터베이스와 대표적인 데이터 접근 방식들을 소개합니다.

### **1. H2 데이터베이스**

- **Java 기반 경량 인메모리 DB**로, 테스트 및 개발 환경에서 주로 사용.
- 애플리케이션 내에서 메모리상에 데이터베이스를 생성하고, 애플리케이션 종료 시 데이터가 사라집니다.
- **SQL 콘솔**을 통해 직접 데이터 조회 및 수정이 가능합니다.

### **H2 데이터베이스 설정**

```properties
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.url=jdbc:h2:~/test
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
```

**H2 데이터베이스**는 자바 애플리케이션에서 사용되는 경량의 인메모리 데이터베이스입니다. 주로 테스트 및 개발 환경에서 사용됩니다.

- `jdbc:h2:mem:testdb`: 메모리 상에서 실행되는 H2 데이터베이스를 설정합니다. 애플리케이션이 종료되면 데이터베이스도 함께 사라집니다.
- `jdbc:h2:~/test`: 로컬 파일 시스템에 저장되는 H2 데이터베이스를 설정합니다. 이 경우 데이터베이스는 애플리케이션이 종료된 후에도 보존됩니다.
- `org.h2.Driver`: H2 데이터베이스 드라이버 클래스.
- `sa`: 기본 사용자 이름. (비밀번호는 공란으로 설정됨)

```properties
spring.h2.console.enabled=true
```

- **H2 콘솔 활성화**: `http://localhost:8080/h2-console`에서 데이터베이스를 직접 조회하고 실행할 수 있는 **H2 콘솔**을 활성화합니다.

```properties
spring.jpa.hibernate.ddl-auto=update
```

- **Hibernate 설정**: 스프링 부트에서 JPA와 H2를 사용할 때, `ddl-auto`를 `update`로 설정하면 엔티티 클래스의 변화에 따라 데이터베이스 스키마가 자동으로 업데이트됩니다.


### **2. 순수 JDBC**

- **Java 기본 제공 데이터베이스 접근 방식**.
- `java.sql` 패키지의 API를 사용해 **직접 SQL 작성**.
- 개발자가 **커넥션 관리**, **SQL 실행**, **예외 처리**를 모두 직접 해야 함.
- **장점**: 단순한 데이터베이스 작업에 적합.
- **단점**: 코드가 길어지고 복잡해질 수 있음.

### **3. 스프링 jdbcTemplate**

- **스프링에서 제공하는 JDBC 추상화 도구**.
- 커넥션 관리, SQL 실행, 예외 처리 등 **반복적인 작업을 간소화**.
- **SQL은 직접 작성**하지만, **코드는 간결**하게 작성 가능.
- 개발자의 부담을 덜어주면서도 SQL 제어가 필요한 경우에 적합.

### **4. JPA (Java Persistence API)**

- **자바의 ORM 표준 인터페이스**로, **객체와 데이터베이스의 테이블을 매핑**.
- **SQL을 직접 작성하지 않고** 자바 객체를 통해 데이터베이스 작업을 수행.
- `@Entity` 클래스를 통해 데이터베이스 테이블과 **객체 매핑**.
- **객체 지향적인 방식**으로 데이터베이스 작업을 처리하고 싶을 때 적합.

### **5. 스프링 데이터 JPA**

- **스프링이 제공하는 JPA 확장 라이브러리**.
- JPA를 더욱 **간단하게 사용할 수 있도록 도와주는 도구**.
- **CRUD 기능을 자동으로 제공**하는 **리포지토리 인터페이스** 사용.
- 메서드 이름을 기반으로 쿼리가 자동 생성되며, **구현 없이 데이터베이스와 상호작용** 가능.
- **빠르고 쉽게 데이터베이스 작업을 하고 싶을 때**, 특히 **CRUD 작업에 매우 유용**.

### **MyBatis 설정**

```properties
mybatis.mapper-locations=mappers/*.xml
```

**MyBatis**는 자바 객체와 SQL 간의 매핑을 관리하는 프레임워크입니다. 이 설정은 **Mapper XML 파일**의 위치를 지정하는 부분입니다.
- `mappers/*.xml`: `mappers` 폴더 아래에 위치한 **MyBatis Mapper XML 파일**을 사용하여 SQL 쿼리를 정의하고, 이를 자바 객체에 매핑합니다.

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN""http://mybatis.org/dtd/mybatis-3-mapper.dtd">
```

- **MyBatis Mapper XML 파일**의 기본 구조입니다. MyBatis에서 사용할 SQL 문을 정의할 때 사용합니다. 이 XML 파일을 통해 데이터베이스와 직접 SQL 쿼리를 수행할 수 있습니다.

### **MyBatisX 플러그인**

- **MyBatisX 플러그인**은 **MyBatis**를 사용할 때, SQL과 자바 코드 간의 매핑을 도와주는 개발 도구입니다. 이 플러그인은 **IDE**에서 더 나은 개발 경험을 제공하며, 코드 자동 완성 및 SQL 매핑을 지원합니다.

### **요약**

1. **H2 데이터베이스**: 경량 인메모리 데이터베이스로 테스트 및 개발에 적합.
2. **순수 JDBC**: SQL을 직접 작성하고, 모든 작업을 수동으로 처리해야 하는 방식.
3. **스프링 jdbcTemplate**: 반복적인 작업을 줄여주며, SQL을 간결하게 처리.
4. **JPA**: 자바 객체를 통해 데이터베이스와 상호작용하는 객체 지향적인 ORM.
5. **스프링 데이터 JPA**: JPA를 쉽게 사용할 수 있도록 지원하며, 자동화된 CRUD 기능 제공.

스프링 데이터베이스 작업 방식은 **직접적인 SQL 제어**가 필요한 경우부터 **자동화된 CRUD**까지 다양한 선택지를 제공하며, 프로젝트의 요구사항에 따라 적절한 방식을 선택할 수 있습니다.
